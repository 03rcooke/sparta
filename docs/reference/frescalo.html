<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Frescalo trend analysis — frescalo â€¢ sparta</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">sparta</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/sparta_vignette.html">sparta - Species Presence/Absence R Trends Analyses</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Frescalo trend analysis</h1>
    </div>

    
    <p>A function for using Frescalo (Hill, 2011), a tool for analysing occurrence data when
recording effort is not known. This function returns the output from Frescalo to the 
R session and saves it to the path specified by <code>sinkdir</code>. By setting 
<code>plot_fres</code> to <code>TRUE</code> maps of the results will also be saved. Plotting the 
returned object gives a useful summary.</p>
    

    <pre class="usage"><span class='fu'>frescalo</span>(<span class='no'>Data</span>, <span class='no'>frespath</span>, <span class='no'>time_periods</span>, <span class='no'>site_col</span>, <span class='no'>sp_col</span>, <span class='kw'>year_col</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>start_col</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>end_col</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>species_to_include</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>sinkdir</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>plot_fres</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>Fres_weights</span> <span class='kw'>=</span> <span class='st'>"LCGB"</span>,
  <span class='kw'>non_benchmark_sp</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>fres_site_filter</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>phi</span> <span class='kw'>=</span> <span class='fl'>0.74</span>,
  <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0.27</span>, <span class='kw'>trend_option</span> <span class='kw'>=</span> <span class='st'>"arithmetic"</span>, <span class='kw'>NYears</span> <span class='kw'>=</span> <span class='fl'>10</span>,
  <span class='kw'>ignore.ireland</span> <span class='kw'>=</span> <span class='no'>F</span>, <span class='kw'>ignore.channelislands</span> <span class='kw'>=</span> <span class='no'>F</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>Data</th>
      <td><p>A dataframe object. This should consist of rows of
observations and columns indicating the species and location as well as
either the year of the observation or columns specifying the start and end
dates of the observation. It is important that date columns are in
a date format.</p></td>
    </tr>
    <tr>
      <th>frespath</th>
      <td><p>the path to the frescalo .exe file. This can be downloaded from
http://www.brc.ac.uk/biblio/frescalo-computer-program-analyse-your-biological-records.
It is currently only available for Windows. The directory where the .exe
is saved should be writeable.</p></td>
    </tr>
    <tr>
      <th>time_periods</th>
      <td><p>A dataframe object with two columns. The first column contains the
start year of each time period and the second column contains the end year of 
each time period. Time periods should not overlap.</p></td>
    </tr>
    <tr>
      <th>site_col</th>
      <td><p>The name of the site column in <code>Data</code></p></td>
    </tr>
    <tr>
      <th>sp_col</th>
      <td><p>The name of the species column in <code>Data</code></p></td>
    </tr>
    <tr>
      <th>year_col</th>
      <td><p>The name of the year column in <code>Data</code></p></td>
    </tr>
    <tr>
      <th>start_col</th>
      <td><p>The name of the start date column in <code>Data</code></p></td>
    </tr>
    <tr>
      <th>end_col</th>
      <td><p>The name of the end date column in <code>Data</code></p></td>
    </tr>
    <tr>
      <th>species_to_include</th>
      <td><p>Optionally a character vector listing the names of species to be used.
Species not in your list are ignored. This is useful if you are only interested in a
subset of species.</p></td>
    </tr>
    <tr>
      <th>sinkdir</th>
      <td><p>String giving the output directory for results</p></td>
    </tr>
    <tr>
      <th>plot_fres</th>
      <td><p>Logical, if <code>TRUE</code> maps are produced by Frescalo. Default is 
<code>FALSE</code>. CURRENTLY ONLY WORKS FOR UK GRID-REFERENCE DATA</p></td>
    </tr>
    <tr>
      <th>Fres_weights</th>
      <td><p>'LC*' specifies a weights files based on landcover data.
The suffix specifies the extend ('LCUK', 'LCNI' or 'LCGB'). 'VP' uses a weights
file based on vascular plant data for the UK
, both are included in the package. Alternativly a custom weights file can be
given as a data.frame. This must have three columns: target cell, neighbour cell,
weight. Default is 'LCGB'</p></td>
    </tr>
    <tr>
      <th>non_benchmark_sp</th>
      <td><p>a character vector, giving the names of species not to be
used as benchmarks in Frescalo. Default is <code>NULL</code> and all species are used.
See Hill, 2011 for reasons why some species may not be suitable benchmarks.</p></td>
    </tr>
    <tr>
      <th>fres_site_filter</th>
      <td><p>Optionally a character vector giving
the names of sites to be used in the trend analysis. Sites not include in this
list are not used for estimating TFactors. Default is <code>NULL</code> and all sites are
used.</p></td>
    </tr>
    <tr>
      <th>phi</th>
      <td><p>Target frequency of frequency-weighted mean frequency. Default is 0.74 as in
Hill (2011). If set to <code>NULL</code>, phi will start at 0.74 and will be increased if
the value is smaller than the 98.5 percentile of input phi, limited to
to a maximum of 0.95.</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>the proportion of the expected number of species in a cell to be treated as
benchmarks. Default is 0.27 as in Hill (2011). This is limited to 0.08 to 0.50.</p></td>
    </tr>
    <tr>
      <th>trend_option</th>
      <td><p>Set the method by which you wish to calculate percentage change. This can currently
be set to either <code>'arithmetic'</code> (default) or <code>'geometric'</code>. Arimthmetic calculates
percentage change in a linear fashion such that a decline of 50% over 50 years is
equal to 10% in 10 years. Using the same example a Geometric trend would be 8.44%
every 10 years as this work on a compound rate.</p></td>
    </tr>
    <tr>
      <th>NYears</th>
      <td><p>The number of years over which you want the percentage change to be calculated (i.e.
10 gives a decadal change). Default = 10</p></td>
    </tr>
    <tr>
      <th>ignore.ireland</th>
      <td><p>Logical, if <code>TRUE</code> Irish hectads are removed. Default
is <code>FALSE</code></p></td>
    </tr>
    <tr>
      <th>ignore.channelislands</th>
      <td><p>Logical, if <code>TRUE</code> channel island hectads are 
removed. Default is <code>FALSE</code></p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Results are saved to file and most are returned in a list to R.</p>
<p>The list object returned is comprised of the following:</p>        
<p></p>
<dt><b>$paths</b></dt><dd><p>This list of file paths provides the locations of the raw data files
        for $log, $stat, $freq and $trend, in that order</p></dd>         
        
        <dt><b>$trend</b></dt><dd><p>This dataframe provides the list of time factors for each species</p></dd>
         
         rll
         -  <code>Species</code>  Name of species
         -  <code>Time</code>  Time period, specified as a class (e.g. 1970); times need not be numeric and are indexed as character strings
         -  <code>TFactor</code>  Time factor, the estimated relative frequency of species at the time
         -  <code>St_Dev</code>  Standard deviation of the time factor, given that spt (defined below) is a weighted sum of binomial variates
         -  <code>X</code>  Number of occurrences of species at the time period
         -  <code>Xspt</code>  Number of occurrences, given reduced weight of locations having very low sampling effort
         -  <code>Xest</code>  Estimated number of occurrences; this should be equal to spt if the algorithm has converged
         -  <code>N&gt;0.00</code>  Number of locations with non-zero probability of the species occurring
         -  <code>N&gt;0.98</code>  Number of locations for which the probability of occurrence was estimated as greater than 0.98
         
       
       <dt><b>$stat</b></dt><dd><p>Location report</p></dd>
        
         rll
         -  <code>Location</code>  Name of location; in this case locations are hectads of the GB National Grid 
         -  <code>Loc_no</code>  Numbering (added) of locations in alphanumeric order 
         -  <code>No_spp</code>  Number of species at that location; the actual number which may be zero 
         -  <code>Phi_in</code>  Initial value of phi, the frequency-weighted mean frequency 
         -  <code>Alpha</code>  Sampling effort multiplier (to achieve standard value of phi) 
         -  <code>Wgt_n2</code>  effective number N2 for the neighbourhood weights; this is small if there are few floristically similar hectads close to the target hectad.  It is (sum weights)^2 / (sum weights^2) 
         -  <code>Phi_out</code>  Value of phi after rescaling; constant, if the algorithm has converged
         -  <code>Spnum_in</code>  Sum of neighbourhood frequencies before rescaling
         -  <code>Spnum_out</code>  Estimated species richness, i.e. sum of neighbourhood frequencies after rescaling
         -  <code>Iter</code>  Number of iterations for algorithm to converge
         
             
        <dt><b>$freq</b></dt><dd><p>Listing of rescaled species frequencies</p></dd>
        
         rll
         -  <code>Location</code>  Name of location
         -  <code>Species</code>  Name of species
         -  <code>Pres</code>  Record of species in location (1 = recorded, 0 = not recorded)
         -  <code>Freq</code>  Frequency of species in neighbourhood of location
         -  <code>Freq_1</code>  Estimated probabilty of occurrence, i.e. frequency of species after rescaling
         -  <code>SD_Frq1</code>  Standard error of Freq_1, calculated on the assumption that Freq is a binomial variate with standard error sqrt(Freq*(1-Freq)/ Wgt_n2), where Wgt_n2 is as defined for samples.txt in section (b)
         -  <code>Rank</code>  Rank of frequency in neighbourhood of location
         -  <code>Rank_1</code>  Rescaled rank, defined as Rank/Estimated species richness
         
              
        <dt><b>$log</b></dt><dd><p>This records all the output sent to the console when running frescalo</p></dd>
          
        <dt><b>$lm_stats</b></dt><dd><p>The results of linear modelling of TFactors</p></dd>
        
         rll
         -  <code>SPECIES</code>  Name of species used internally by frescalo
         -  <code>NAME</code>  Name of species as appears in raw data
         -  <code>b</code>  The slope of the model
         -  <code>a</code>  The intercept
         -  <code>b_std_err</code>  Standard error of the slope
         -  <code>b_tval</code>  t-value for a test of significance of the slope
         -  <code>b_pval</code>  p-value for a test of significance of the slope
         -  <code>a_std_err</code>  Standard error of the intercept
         -  <code>a_tval</code>  t-value for a test of significance of the intercept
         -  <code>a_pval</code>  p-value for a test of significance of the intercept
         -  <code>adj_r2</code>  Rescaled rank, defined as Rank/Estimated species richness
         -  <code>r2</code>  t-value for a test of significance of the intercept
         -  <code>F_val</code>  F-value of the model
         -  <code>F_num_df</code>  Degrees of freedom of the model
         -  <code>F_den_df</code>  Denominator degrees of freedom from the F-statistic
         -  <code>Ymin</code>  The earliest year in the dataset
         -  <code>Ymax</code>  The latest year in the dataset
         -  <code>change_...</code>  The percentage change dependent on the values given to <code>trend_option</code> and <code>NYears</code>.
         
         The following columns are only produced when there are only two time periods
         rll
         -  <code>Z_VAL</code>  Z-value for the significance test of the trend
         -  <code>SIG_95</code>  A logical statement indicating if the trend is significant (TRUE) or non-significant (FALSE)
         

    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Hill, Mark. Local frequency as a key to interpreting species occurrence data when
recording effort is not known. 2011. <em>Methods in Ecology and Evolution</em>, 3 (1), 195-205.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># NOT RUN {</span>
<span class='co'># Load data</span>
<span class='fu'>data</span>(<span class='no'>unicorns</span>)

<span class='co'># Run frescalo (data is save to the working directory as sinkdir is not given)</span>
<span class='no'>fres_out</span> <span class='kw'>&lt;-</span> <span class='fu'>frescalo</span>(<span class='kw'>Data</span> <span class='kw'>=</span> <span class='no'>unicorns</span>,
                     <span class='kw'>time_periods</span> <span class='kw'>=</span> <span class='fu'>data.frame</span>(<span class='kw'>start</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>1980</span>,<span class='fl'>1990</span>),<span class='kw'>end</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>1989</span>,<span class='fl'>1999</span>)),
                     <span class='kw'>site_col</span> <span class='kw'>=</span> <span class='st'>'hectad'</span>,
                     <span class='kw'>sp_col</span> <span class='kw'>=</span> <span class='st'>'CONCEPT'</span>,
                     <span class='kw'>start_col</span> <span class='kw'>=</span> <span class='st'>'TO_STARTDATE'</span>,
                     <span class='kw'>end_col</span> <span class='kw'>=</span> <span class='st'>'Date'</span>)
<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#references">References</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Tom August, Gary Powney, Charlie Outhwaite, Colin Harrower, Mark Hill, Nick Isaac.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
